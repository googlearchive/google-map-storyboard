<!--
The 'google-map-scene' is contained inside a 'google-map-storyboard'.
Each scene is associated with a given location (an address).
The innerHTML of each scene is rendered at this location.

<b>Example</b> - Put an image on a scene:

    <google-map-scene address="Sydney, Australia" zoom="5">
      <img src="image.png">
    </google-map-scene>

@element google-map-scene
@homepage https://github.com/googlemaps/google-map-storyboard
-->
<!--
Fired when the scene's location has been changed.

@event scene-location-changed
-->
<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/google-apis/google-apis.html">

<polymer-element name="google-map-scene" attributes="address zoom">
<template>
  <style>
  </style>

</template>

<script>
  Polymer({

    /**
     * The address associated with the scene.
     *
     * @attribute address
     * @type string
     * @default null
     */
    address: null,

    /**
     * The zoom of the map.
     *
     * @attribute zoom
     * @type number
     * @default null
     */
    zoom: 10,

    /**
     * The location of the scene.
     *
     * @property location
     * @type google.maps.LatLng
     * @default null
     */
    location: null,

    /**
     * The marker for this scene.
     *
     * @property marker
     * @type google.maps.Marker
     * @default null
     */
    marker: null,


    /**
     * If the address should be ignored. 
     * True if the current address has been geocoded.
     *
     * @property ignoreAddress
     * @type Boolean
     * @default true
     */
    ignoreAddress: true,

    attached: function() {
      this.fireSceneChanged();
    },

    detached: function() {
      if (this.marker) this.marker.setMap(null);
      this.fireSceneChanged();
    },

    getStoryboard: function() {
      var storyboard = this.parentNode;
      return storyboard;
    },

    addressChanged: function() {
      this.ignoreAddress = !this.address;
      this.fireSceneChanged();
    },

    locationChanged: function() {
      if (!this.marker) this.makeMarker();
      this.marker.setPosition(this.location);
      this.fireSceneChanged();
    },

    fireSceneChanged: function() {
      this.fire('scene-changed');
    },

    makeMarker: function() {
      this.marker = new google.maps.Marker({
        map: null,
        location: this.location
      });
    },

    warn: function() {
      console.warn.apply(console, Array.prototype.slice.call(arguments));
      this.fireSceneChanged();
    }

  });
</script>
</polymer-element>
